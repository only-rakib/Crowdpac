{%load static%}
<div id="race_basic">
    <div class="row">
        <div class="col text-center">
            <span class="mini-recipient">
                The Basics
            </span>
        </div>
    </div>
    <div class="row" style="margin-top: .8rem">
        <div class="col text-center">
            <span class="title2">
                What are you thinking of running for?
            </span>
        </div>
    </div>
    <div class="row" style="margin-top: .8rem">
        <div class="col text-center">
            <h5>
                Browse our database of 7,453 races or add a new one.
            </h5>
        </div>
    </div>
    <div class="row" style="margin-top: 2rem">
        <div class="col">
            <label class="mini-recipient__title">State / Region</label>
            <select class="form-control" id="Candidate_State" onchange="selectState(this.id)">
                <option  selected disabled >-Select-</option>
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AZ">Arizona</option>
                <option value="AR">Arkansas</option>
                <option value="CA">California</option>
                <option value="CO">Colorado</option>
                <option value="CT">Connecticut</option>
                <option value="DE">Delaware</option>
                <option value="DC">District Of Columbia</option>
                <option value="FL">Florida</option>
                <option value="GA">Georgia</option>
                <option value="HI">Hawaii</option>
                <option value="ID">Idaho</option>
                <option value="IL">Illinois</option>
                <option value="IN">Indiana</option>
                <option value="IA">Iowa</option>
                <option value="KS">Kansas</option>
                <option value="KY">Kentucky</option>
                <option value="LA">Louisiana</option>
                <option value="ME">Maine</option>
                <option value="MD">Maryland</option>
                <option value="MA">Massachusetts</option>
                <option value="MI">Michigan</option>
                <option value="MN">Minnesota</option>
                <option value="MS">Mississippi</option>
                <option value="MO">Missouri</option>
                <option value="MT">Montana</option>
                <option value="NE">Nebraska</option>
                <option value="NV">Nevada</option>
                <option value="NH">New Hampshire</option>
                <option value="NJ">New Jersey</option>
                <option value="NM">New Mexico</option>
                <option value="NY">New York</option>
                <option value="NC">North Carolina</option>
                <option value="ND">North Dakota</option>
                <option value="OH">Ohio</option>
                <option value="OK">Oklahoma</option>
                <option value="OR">Oregon</option>
                <option value="PA">Pennsylvania</option>
                <option value="RI">Rhode Island</option>
                <option value="SC">South Carolina</option>
                <option value="SD">South Dakota</option>
                <option value="TN">Tennessee</option>
                <option value="TX">Texas</option>
                <option value="UT">Utah</option>
                <option value="VT">Vermont</option>
                <option value="VA">Virginia</option>
                <option value="WA">Washington</option>
                <option value="WV">West Virginia</option>
                <option value="WI">Wisconsin</option>
                <option value="WY">Wyoming</option>
                <option value="VI">U.S. Virgin Islands</option>
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 2rem">
        <div class="col">
            <label class="mini-recipient__title">City or County</label>
            <select class="form-control" id="Candidate_City_or_County" disabled onchange="selectState(this.id)">
                <option  selected disabled >-Select-</option>
            </select>
        </div>
    </div>
    <div class="row" style="margin-top: 2rem">
        <div class="col">
            <label class="mini-recipient__title">Search by position title</label>
            <input class="form-control" type="text"  name="Search_by_position_title" id="Search_by_position_title" placeholder="Enter the name of the office here" disabled onkeyup="selectState(this.id)">
        </div>
    </div>
    <div class="row" id="localRow" style="margin-top: 2rem;display: none">
        <div class="col" style="font-size: 20px">
            <a class="clsm" id="localID" data-toggle="collapse" href="#local" role="button" aria-expanded="true" aria-controls="local"><i class="fas fa-caret-down">Local</i></a>
        </div>
    </div>
    <!--DataCollapse-->
    <div id="local" class="collapse">
        <div class="row">
            <div class="col">
                <table class="table table-striped table-borderless" id="localTable">
                    <thead>
                        <tr>
                            <th scope="col">Location</th>
                            <th scope="col">Office</th>
                            <th scope="col">Next election date</th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for key,value in context.race_local.items %}
                           {% for i in value %}

                                <tr>
                                    <td>{{i.0}}</td>
                                    <td>{{i.1}}</td>
                                    <td>{{i.2}}</td>
                                    <td><a class="rclst" id="{{i.3}}" href="#">Select</a></td>
                                </tr>
                            {% endfor %}
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="row" id="stateRow" style="margin-top: 2rem;display: none">
        <div class="col" style="font-size: 20px">
            <a class="clsm" data-toggle="collapse" href="#state" role="button" aria-expanded="false" aria-controls="state"><i class="fas fa-caret-down">State</i></a>
        </div>
    </div>
    <!--DataCollapse-->
    <div id="state" class="collapse">
        <div class="row">
            <div class="col">
                <table class="table table-striped table-borderless" id="stateTable">
                    <thead>
                        <tr>
                            <th scope="col">Location</th>
                            <th scope="col">Office</th>
                            <th scope="col">Next election date</th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for key,value in context.race_list.items %}
                           {% for i in value %}
                        <tr>
                            <td>{{i.0}}</td>
                            <td>{{i.1}}</td>
                            <td>{{i.2}}</td>
                            <td><a class="rclst" id="{{i.3}}" href="#">Select</a></td>
                        </tr>
                        {%endfor%}
                        {%endfor%}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="row" id="federalRow" style="margin-top: 2rem;display: none">
        <div class="col" style="font-size: 20px">
            <a class="clsm" data-toggle="collapse" href="#federal" role="button" aria-expanded="false" aria-controls="federal"><i class="fas fa-caret-down">Federal</i></a>
        </div>
    </div>
    <!--DataCollapse-->
    <div id="federal" class="collapse">
        <div class="row">
            <div class="col">
                <table class="table table-striped table-borderless" id="federalTable">
                    <thead>
                        <tr>
                            <th scope="col">Location</th>
                            <th scope="col">Office</th>
                            <th scope="col">Next election date</th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for key,value in context.race_list.items %}
                           {% for i in value %}

                        <tr>
                            <td>{{i.0}}</td>
                            <td>{{i.1}}</td>
                            <td>{{i.2}}</td>
                            <td><a class="rclst" id="{{i.3}}" href="#">Select</a></td>
                        </tr>
                        {%endfor%}
                        {%endfor%}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="row" style="margin-top: 2rem;background: #F6F6F6;padding-top: 2rem;padding-bottom: 2rem">
        <div class="col">
            <div class="row">
                <div class="col">
                    <h5>Can't find the race?</h5>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <a class="rclst" href="add_race">Add a new race</a>
                </div>
            </div>
        </div>
        
    </div>
</div>
<script type="text/javascript">
var arr = {}; 
var cn=0
{% for key,values in context.states_city.items %}
    var temp=[];
    {%for i in values%}
       temp.push("{{i|safe}}")
    {%endfor%}
    arr["{{key|safe}}"]=temp;
    
{% endfor %}

function selectState(clicked_id) {
    
    if(clicked_id=="Candidate_State"){
        var states_click = document.getElementById("Candidate_State");
        var state = states_click.options[states_click.selectedIndex].value;
        var cities=[]
        cities = arr[state];
        var select_city = document.getElementById("Candidate_City_or_County");
        for(var i=0;i<cities.length;i++)
        {
            var opt = cities[i];
            var el = document.createElement("option");
            el.textContent = opt;
            el.value = opt;
            select_city.appendChild(el);
        }
        select_city.removeAttribute("disabled");
        document.getElementsByName("Search_by_position_title")[0].removeAttribute("disabled");
        document.getElementById("localRow").style.display = 'block';
        document.getElementById("stateRow").style.display = 'block';
        document.getElementById("federalRow").style.display = 'block';
        var table = document.getElementById("localTable");
        var tr = table.getElementsByTagName("tr");

        var txtValue;
        var myOpts = document.getElementById('Candidate_City_or_County').options;
        
        for (var i = 0; i < tr.length; i++) {
            var td = tr[i].getElementsByTagName("td")[0];
            if (td) {
                txtValue = td.textContent || td.innerText;
          
                  for(var j=0;j<myOpts.length;j++)
                  {
                        var r = "";
                        r=myOpts[j].value;
                        if (txtValue.localeCompare(r)==0) {
                            tr[i].style.display = "";
                           
                            break;

                        } else {
                            tr[i].style.display = "none";
                            
                        }
                  }
              }
        }

        var tableState = document.getElementById("stateTable");
        var tr1 = tableState.getElementsByTagName("tr");

        
        var myOpts1 = state;
        var txtValue1="";
        for (var i = 0; i < tr1.length; i++) {
            var td = tr1[i].getElementsByTagName("td")[0];
            if (td) {
                txtValue1 = td.textContent || td.innerText;
                if (txtValue1.localeCompare(myOpts1)==0) {
                    tr1[i].style.display = "";
                    break;

                } else {
                    tr1[i].style.display = "none";
                }
            }
        }


        var tableFederal = document.getElementById("federalTable");
        var tr2 = tableFederal.getElementsByTagName("tr");

        
        var myOpts2 = document.getElementById('Candidate_State').options;
        var txtValue2="";
        for (var i = 0; i < tr1.length; i++) {
            var td = tr2[i].getElementsByTagName("td")[0];
            if (td) {
                txtValue2 = td.textContent || td.innerText;
                for(var j=0;j<myOpts2.length;j++){
                    if (txtValue2.localeCompare(myOpts2[j].value)==0) {
                        tr2[i].style.display = "";
                        break;

                    } else {
                        tr2[i].style.display = "none";
                    }
                }
            }
        }
      }
  else if(clicked_id=="Candidate_City_or_County")
  {

    var states_click = document.getElementById("Candidate_City_or_County");

    var myOpts = states_click.options[states_click.selectedIndex].value;

    var table = document.getElementById("localTable");
    var tr = table.getElementsByTagName("tr");

    var txtValue;
    
    
    for (var i = 0; i < tr.length; i++) {
        var td = tr[i].getElementsByTagName("td")[0];
        if (td) {
            txtValue = td.textContent || td.innerText;
            if (txtValue.localeCompare(myOpts)==0) {
                tr[i].style.display = "";  
                    break;

            } else {
                 tr[i].style.display = "none";
                        
            }
              
        }
    }
  }
  else if(clicked_id=="Search_by_position_title")
  {
    var input,filter,td,txtValue;
    

    input = document.getElementById("Search_by_position_title");
    filter = input.value.toUpperCase();
    var table = document.getElementById("localTable");
    var tr = table.getElementsByTagName("tr");
    
        for (i = 0; i < tr.length; i++) {
            
            td = tr[i].getElementsByTagName("td")[1];
            if (td) {
              txtValue = td.textContent || td.innerText;
                  if (txtValue.toUpperCase().indexOf(filter) > -1 ) {
                    tr[i].style.display = "";
                    
                  } else {
                    tr[i].style.display = "none";
                  }
            }
        }
  }
}
</script>